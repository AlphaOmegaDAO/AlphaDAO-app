{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { EnvHelper } from \"../helpers/Environment\";\nimport { useLocation } from \"react-router-dom\";\nimport { useWeb3Context } from \"src/hooks/web3Context\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { getParameterByName } from \"../helpers/QueryParameterHelper\";\nconst SEGMENT_API_KEY = EnvHelper.getSegmentKey();\nexport default function useSegmentAnalytics() {\n  _s();\n\n  const [prevPath, setPrevPath] = useState(null);\n  const [loadedSegment, setLoadedSegment] = useState(false);\n  const analytics = window.analytics = window.analytics || [];\n  const location = useLocation();\n  const {\n    address\n  } = useWeb3Context();\n  React.useEffect(() => {\n    if (SEGMENT_API_KEY && SEGMENT_API_KEY.length > 1) {\n      const path = location.pathname + location.search + location.hash;\n      const utmSource = getParameterByName(\"utm_source\", path);\n      const utmMedium = getParameterByName(\"utm_medium\", path);\n      const utmCampaign = getParameterByName(\"utm_campaign\", path);\n      const utm = {\n        utmSource: utmSource,\n        utmMedium: utmMedium,\n        utmCampaign: utmCampaign\n      };\n      initSegmentAnalytics(utm);\n      setLoadedSegment(true);\n    }\n  }, []);\n  React.useEffect(() => {\n    if (loadedSegment) {\n      const currentPath = location.pathname + location.search + location.hash;\n\n      if (currentPath !== prevPath) {\n        setPrevPath(currentPath);\n        analytics.page(\"\", currentPath, {}, {\n          context: {\n            ip: \"0.0.0.0\"\n          }\n        });\n      }\n    }\n  }, [location]);\n  React.useEffect(() => {\n    if (loadedSegment && address) {\n      analytics.identify(address, {\n        wallet: address,\n        sessionId: uuidv4()\n      });\n    }\n  }, [address]);\n}\n\n_s(useSegmentAnalytics, \"68TZHaejFcPqJC099vG9Ry2cMeY=\", false, function () {\n  return [useLocation, useWeb3Context];\n});\n\nfunction initSegmentAnalytics(utm) {\n  var analytics = window.analytics = window.analytics || [];\n\n  if (!analytics.initialize) {\n    if (analytics.invoked) window.console && console.error && console.error(\"Segment snippet included twice.\");else {\n      analytics.invoked = !0;\n      analytics.methods = [\"trackSubmit\", \"trackClick\", \"trackLink\", \"trackForm\", \"pageview\", \"identify\", \"reset\", \"group\", \"track\", \"ready\", \"alias\", \"debug\", \"page\", \"once\", \"off\", \"on\", \"addSourceMiddleware\", \"addIntegrationMiddleware\", \"setAnonymousId\", \"addDestinationMiddleware\"];\n\n      analytics.factory = function (e) {\n        return function () {\n          var t = Array.prototype.slice.call(arguments);\n          t.unshift(e);\n          analytics.push(t);\n          return analytics;\n        };\n      };\n\n      for (var e = 0; e < analytics.methods.length; e++) {\n        var key = analytics.methods[e];\n        analytics[key] = analytics.factory(key);\n      }\n\n      analytics.load = function (key, e) {\n        var t = document.createElement(\"script\");\n        t.type = \"text/javascript\";\n        t.async = !0;\n        t.src = \"https://cdn.segment.com/analytics.js/v1/\" + key + \"/analytics.min.js\";\n        var n = document.getElementsByTagName(\"script\")[0];\n        n.parentNode.insertBefore(t, n);\n        analytics._loadOptions = e;\n      };\n\n      analytics._writeKey = SEGMENT_API_KEY;\n      analytics.SNIPPET_VERSION = \"4.15.3\";\n      analytics.load(SEGMENT_API_KEY);\n      analytics.page(\"UTM Check\", utm);\n    }\n  }\n}","map":{"version":3,"sources":["C:/arete/AlphaDAO-react/src/hooks/useSegmentAnalytics.js"],"names":["React","useState","EnvHelper","useLocation","useWeb3Context","v4","uuidv4","getParameterByName","SEGMENT_API_KEY","getSegmentKey","useSegmentAnalytics","prevPath","setPrevPath","loadedSegment","setLoadedSegment","analytics","window","location","address","useEffect","length","path","pathname","search","hash","utmSource","utmMedium","utmCampaign","utm","initSegmentAnalytics","currentPath","page","context","ip","identify","wallet","sessionId","initialize","invoked","console","error","methods","factory","e","t","Array","prototype","slice","call","arguments","unshift","push","key","load","document","createElement","type","async","src","n","getElementsByTagName","parentNode","insertBefore","_loadOptions","_writeKey","SNIPPET_VERSION"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { EnvHelper } from \"../helpers/Environment\";\nimport { useLocation } from \"react-router-dom\";\nimport { useWeb3Context } from \"src/hooks/web3Context\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { getParameterByName } from \"../helpers/QueryParameterHelper\";\n\nconst SEGMENT_API_KEY = EnvHelper.getSegmentKey();\n\nexport default function useSegmentAnalytics() {\n  const [prevPath, setPrevPath] = useState(null);\n  const [loadedSegment, setLoadedSegment] = useState(false);\n  const analytics = (window.analytics = window.analytics || []);\n  const location = useLocation();\n  const { address } = useWeb3Context();\n\n  React.useEffect(() => {\n    if (SEGMENT_API_KEY && SEGMENT_API_KEY.length > 1) {\n      const path = location.pathname + location.search + location.hash;\n      const utmSource = getParameterByName(\"utm_source\", path);\n      const utmMedium = getParameterByName(\"utm_medium\", path);\n      const utmCampaign = getParameterByName(\"utm_campaign\", path);\n      const utm = {\n        utmSource: utmSource,\n        utmMedium: utmMedium,\n        utmCampaign: utmCampaign,\n      };\n      initSegmentAnalytics(utm);\n      setLoadedSegment(true);\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (loadedSegment) {\n      const currentPath = location.pathname + location.search + location.hash;\n      if (currentPath !== prevPath) {\n        setPrevPath(currentPath);\n        analytics.page(\"\", currentPath, {}, { context: { ip: \"0.0.0.0\" } });\n      }\n    }\n  }, [location]);\n\n  React.useEffect(() => {\n    if (loadedSegment && address) {\n      analytics.identify(address, {\n        wallet: address,\n        sessionId: uuidv4(),\n      });\n    }\n  }, [address]);\n}\n\nfunction initSegmentAnalytics(utm) {\n  var analytics = (window.analytics = window.analytics || []);\n  if (!analytics.initialize) {\n    if (analytics.invoked) window.console && console.error && console.error(\"Segment snippet included twice.\");\n    else {\n      analytics.invoked = !0;\n      analytics.methods = [\n        \"trackSubmit\",\n        \"trackClick\",\n        \"trackLink\",\n        \"trackForm\",\n        \"pageview\",\n        \"identify\",\n        \"reset\",\n        \"group\",\n        \"track\",\n        \"ready\",\n        \"alias\",\n        \"debug\",\n        \"page\",\n        \"once\",\n        \"off\",\n        \"on\",\n        \"addSourceMiddleware\",\n        \"addIntegrationMiddleware\",\n        \"setAnonymousId\",\n        \"addDestinationMiddleware\",\n      ];\n      analytics.factory = function (e) {\n        return function () {\n          var t = Array.prototype.slice.call(arguments);\n          t.unshift(e);\n          analytics.push(t);\n          return analytics;\n        };\n      };\n      for (var e = 0; e < analytics.methods.length; e++) {\n        var key = analytics.methods[e];\n        analytics[key] = analytics.factory(key);\n      }\n      analytics.load = function (key, e) {\n        var t = document.createElement(\"script\");\n        t.type = \"text/javascript\";\n        t.async = !0;\n        t.src = \"https://cdn.segment.com/analytics.js/v1/\" + key + \"/analytics.min.js\";\n        var n = document.getElementsByTagName(\"script\")[0];\n        n.parentNode.insertBefore(t, n);\n        analytics._loadOptions = e;\n      };\n      analytics._writeKey = SEGMENT_API_KEY;\n      analytics.SNIPPET_VERSION = \"4.15.3\";\n      analytics.load(SEGMENT_API_KEY);\n\n      analytics.page(\"UTM Check\", utm);\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}