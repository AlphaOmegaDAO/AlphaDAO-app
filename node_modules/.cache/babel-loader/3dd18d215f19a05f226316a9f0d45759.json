{"ast":null,"code":"var _jsxFileName = \"C:\\\\arete\\\\AlphaDAO-react\\\\src\\\\views\\\\33Together\\\\PoolWithdraw.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Box, Button, FormControl, InputAdornment, InputLabel, Link, OutlinedInput, SvgIcon, Typography, useMediaQuery } from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\nimport ConnectButton from \"../../components/ConnectButton.jsx\";\nimport { useWeb3Context } from \"../../hooks\";\nimport { getTokenImage } from \"src/helpers/index\";\nimport { trim } from \"src/helpers\";\nimport { isPendingTxn, txnButtonText } from \"../../slices/PendingTxnsSlice\";\nimport { getEarlyExitFee, poolWithdraw } from \"../../slices/PoolThunk\";\nimport { calculateOdds } from \"../../helpers/33Together\";\nimport { ReactComponent as ArrowUp } from \"@svgr/webpack?-svgo,+titleProp,+ref!src/assets/icons/arrow-up.svg\";\nimport { error } from \"../../slices/MessagesSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst sohmImg = getTokenImage(\"sohm\");\nexport const PoolWithdraw = props => {\n  _s();\n\n  const dispatch = useDispatch();\n  const {\n    provider,\n    address,\n    chainID\n  } = useWeb3Context();\n  const [quantity, setQuantity] = useState(0);\n  const [exitFee, setExitFee] = useState(0);\n  const [newOdds, setNewOdds] = useState(0);\n  const isPoolLoading = useSelector(state => state.poolData.loading);\n  const isMobileScreen = useMediaQuery(\"(max-width: 513px)\");\n  const poolBalance = useSelector(state => {\n    return state.account.balances && parseFloat(state.account.balances.pool);\n  });\n  const pendingTransactions = useSelector(state => {\n    return state.pendingTransactions;\n  });\n  const poolIsLocked = useSelector(state => {\n    return state.poolData && state.poolData.isRngRequested;\n  });\n\n  const setMax = () => {\n    setQuantity(poolBalance);\n  };\n\n  const onWithdraw = async action => {\n    // eslint-disable-next-line no-restricted-globals\n    if (isNaN(quantity) || quantity === 0 || quantity === \"\") {\n      // eslint-disable-next-line no-alert\n      dispatch(error(\"Please enter a value!\"));\n    } else {\n      await dispatch(poolWithdraw({\n        action,\n        value: quantity.toString(),\n        provider,\n        address,\n        networkID: chainID\n      }));\n    }\n  }; // go fetch the Exit Fee from the contract\n\n\n  const calcEarlyExitFee = async () => {\n    const result = await dispatch(getEarlyExitFee({\n      value: quantity.toString(),\n      provider,\n      address,\n      networkID: chainID\n    }));\n\n    if (result.payload) {\n      let userBalanceAfterWithdraw = poolBalance - quantity;\n      let userOdds = calculateOdds(userBalanceAfterWithdraw, props.totalPoolDeposits, props.winners);\n      setNewOdds(trim(userOdds, 4));\n      setExitFee(result.payload.withdraw.stringExitFee);\n    } else {\n      dispatch(error(result.error.message));\n      setExitFee(0);\n    }\n  };\n\n  useEffect(() => {\n    // when user types quantity display a warning with their early exit fee\n    if (quantity > 0 && quantity <= poolBalance) {\n      calcEarlyExitFee();\n    } else if (quantity > poolBalance) {\n      dispatch(error(\"You cannot withdraw more than your pool balance\"));\n      setExitFee(0);\n    }\n  }, [quantity]);\n  useEffect(() => {\n    props.setInfoTooltipMessage([\"You can choose to withdraw the deposited fund at any time. By withdrawing the fund, you are eliminating reducing the chance to win the prize in this pool in future prize periods\"]);\n  }, []);\n\n  if (poolIsLocked) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      alignItems: \"center\",\n      className: \"pool-deposit-ui\",\n      flexDirection: \"column\",\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        children: \"This Prize Pool is unable to accept withdrawals at this time.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        style: {\n          marginTop: \"0.5rem\"\n        },\n        children: \"Withdrawals can be made once the prize has been awarded.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        style: {\n          marginTop: \"0.5rem\"\n        },\n        children: \"Check back soon!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    display: \"flex\",\n    justifyContent: \"center\",\n    className: \"pool-deposit-ui\",\n    children: !address ? /*#__PURE__*/_jsxDEV(ConnectButton, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Box, {\n      className: \"withdrawal-container\",\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        alignItems: \"center\",\n        flexDirection: `${isMobileScreen ? \"column\" : \"row\"}`,\n        children: [/*#__PURE__*/_jsxDEV(FormControl, {\n          className: \"ohm-input\",\n          variant: \"outlined\",\n          color: \"primary\",\n          children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n            htmlFor: \"amount-input\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(OutlinedInput, {\n            id: \"amount-input\",\n            type: \"number\",\n            placeholder: \"Enter an amount\",\n            className: \"pool-input\",\n            value: quantity,\n            onChange: e => setQuantity(parseFloat(e.target.value)),\n            startAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n              position: \"start\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"logo-holder\",\n                children: sohmImg\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 19\n            }, this),\n            labelWidth: 0,\n            endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n              position: \"end\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"text\",\n                onClick: setMax,\n                children: \"Max\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 135,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"pool-withdraw-button\",\n          variant: \"contained\",\n          color: \"primary\",\n          disabled: isPendingTxn(pendingTransactions, \"pool_withdraw\"),\n          onClick: () => onWithdraw(\"withdraw\"),\n          children: exitFee > 0 ? txnButtonText(pendingTransactions, \"pool_withdraw\", \"Withdraw Early & pay \" + exitFee + \" sOHM\") : txnButtonText(pendingTransactions, \"pool_withdraw\", \"Withdraw sOHM\")\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), newOdds > 0 && quantity > 0 && /*#__PURE__*/_jsxDEV(Box, {\n        padding: 1,\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          color: \"error\",\n          variant: \"body2\",\n          children: [\"Withdrawing \", quantity, \" sOHM reduces your odds of winning to 1 in \", newOdds, \"\\xA0\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }, this), exitFee > 0 && /*#__PURE__*/_jsxDEV(Box, {\n        margin: 1,\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          color: \"error\",\n          children: [\"Early withdraw will incur a fairness fee of \", exitFee, \". \\xA0\", /*#__PURE__*/_jsxDEV(Link, {\n            href: \"https://v3.docs.pooltogether.com/protocol/prize-pool/fairness\",\n            target: \"_blank\",\n            rel: \"noreferrer\",\n            color: \"primary\",\n            children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 19\n            }, this), \"Read more about Fairness\", \" \", /*#__PURE__*/_jsxDEV(SvgIcon, {\n              component: ArrowUp,\n              style: {\n                fontSize: \"1rem\",\n                verticalAlign: \"middle\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `stake-user-data`,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"data-row\",\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            align: \"left\",\n            children: \"Your Pooled Balance (withdrawable)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body1\",\n            align: \"right\",\n            children: isPoolLoading ? /*#__PURE__*/_jsxDEV(Skeleton, {\n              width: \"80px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [new Intl.NumberFormat(\"en-US\").format(poolBalance), \" 33T\"]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PoolWithdraw, \"t2BERAL86PD6yGibwIN0HNRkgoY=\", false, function () {\n  return [useDispatch, useWeb3Context, useSelector, useMediaQuery, useSelector, useSelector, useSelector];\n});\n\n_c = PoolWithdraw;\nPoolWithdraw.propTypes = {\n  totalPoolDeposits: PropTypes.number,\n  winners: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  setInfoTooltipMessage: PropTypes.func\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"PoolWithdraw\");","map":{"version":3,"sources":["C:/arete/AlphaDAO-react/src/views/33Together/PoolWithdraw.jsx"],"names":["useEffect","useState","PropTypes","useDispatch","useSelector","Box","Button","FormControl","InputAdornment","InputLabel","Link","OutlinedInput","SvgIcon","Typography","useMediaQuery","Skeleton","ConnectButton","useWeb3Context","getTokenImage","trim","isPendingTxn","txnButtonText","getEarlyExitFee","poolWithdraw","calculateOdds","error","sohmImg","PoolWithdraw","props","dispatch","provider","address","chainID","quantity","setQuantity","exitFee","setExitFee","newOdds","setNewOdds","isPoolLoading","state","poolData","loading","isMobileScreen","poolBalance","account","balances","parseFloat","pool","pendingTransactions","poolIsLocked","isRngRequested","setMax","onWithdraw","action","isNaN","value","toString","networkID","calcEarlyExitFee","result","payload","userBalanceAfterWithdraw","userOdds","totalPoolDeposits","winners","withdraw","stringExitFee","message","setInfoTooltipMessage","marginTop","e","target","ArrowUp","fontSize","verticalAlign","Intl","NumberFormat","format","propTypes","number","oneOfType","string","func"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  Box,\n  Button,\n  FormControl,\n  InputAdornment,\n  InputLabel,\n  Link,\n  OutlinedInput,\n  SvgIcon,\n  Typography,\n  useMediaQuery,\n} from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\nimport ConnectButton from \"../../components/ConnectButton.jsx\";\nimport { useWeb3Context } from \"../../hooks\";\nimport { getTokenImage } from \"src/helpers/index\";\nimport { trim } from \"src/helpers\";\nimport { isPendingTxn, txnButtonText } from \"../../slices/PendingTxnsSlice\";\nimport { getEarlyExitFee, poolWithdraw } from \"../../slices/PoolThunk\";\nimport { calculateOdds } from \"../../helpers/33Together\";\nimport { ReactComponent as ArrowUp } from \"src/assets/icons/arrow-up.svg\";\nimport { error } from \"../../slices/MessagesSlice\";\n\nconst sohmImg = getTokenImage(\"sohm\");\n\nexport const PoolWithdraw = props => {\n  const dispatch = useDispatch();\n  const { provider, address, chainID } = useWeb3Context();\n  const [quantity, setQuantity] = useState(0);\n  const [exitFee, setExitFee] = useState(0);\n  const [newOdds, setNewOdds] = useState(0);\n  const isPoolLoading = useSelector(state => state.poolData.loading);\n  const isMobileScreen = useMediaQuery(\"(max-width: 513px)\");\n\n  const poolBalance = useSelector(state => {\n    return state.account.balances && parseFloat(state.account.balances.pool);\n  });\n\n  const pendingTransactions = useSelector(state => {\n    return state.pendingTransactions;\n  });\n\n  const poolIsLocked = useSelector(state => {\n    return state.poolData && state.poolData.isRngRequested;\n  });\n\n  const setMax = () => {\n    setQuantity(poolBalance);\n  };\n\n  const onWithdraw = async action => {\n    // eslint-disable-next-line no-restricted-globals\n    if (isNaN(quantity) || quantity === 0 || quantity === \"\") {\n      // eslint-disable-next-line no-alert\n      dispatch(error(\"Please enter a value!\"));\n    } else {\n      await dispatch(poolWithdraw({ action, value: quantity.toString(), provider, address, networkID: chainID }));\n    }\n  };\n\n  // go fetch the Exit Fee from the contract\n  const calcEarlyExitFee = async () => {\n    const result = await dispatch(\n      getEarlyExitFee({ value: quantity.toString(), provider, address, networkID: chainID }),\n    );\n    if (result.payload) {\n      let userBalanceAfterWithdraw = poolBalance - quantity;\n      let userOdds = calculateOdds(userBalanceAfterWithdraw, props.totalPoolDeposits, props.winners);\n      setNewOdds(trim(userOdds, 4));\n      setExitFee(result.payload.withdraw.stringExitFee);\n    } else {\n      dispatch(error(result.error.message));\n      setExitFee(0);\n    }\n  };\n\n  useEffect(() => {\n    // when user types quantity display a warning with their early exit fee\n    if (quantity > 0 && quantity <= poolBalance) {\n      calcEarlyExitFee();\n    } else if (quantity > poolBalance) {\n      dispatch(error(\"You cannot withdraw more than your pool balance\"));\n      setExitFee(0);\n    }\n  }, [quantity]);\n\n  useEffect(() => {\n    props.setInfoTooltipMessage([\n      \"You can choose to withdraw the deposited fund at any time. By withdrawing the fund, you are eliminating reducing the chance to win the prize in this pool in future prize periods\",\n    ]);\n  }, []);\n\n  if (poolIsLocked) {\n    return (\n      <Box display=\"flex\" alignItems=\"center\" className=\"pool-deposit-ui\" flexDirection=\"column\">\n        {/*<img src={Warning} className=\"w-10 sm:w-14 mx-auto mb-4\" />*/}\n        <Typography variant=\"h6\">This Prize Pool is unable to accept withdrawals at this time.</Typography>\n        <Typography variant=\"body1\" style={{ marginTop: \"0.5rem\" }}>\n          Withdrawals can be made once the prize has been awarded.\n        </Typography>\n        <Typography variant=\"body1\" style={{ marginTop: \"0.5rem\" }}>\n          Check back soon!\n        </Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box display=\"flex\" justifyContent=\"center\" className=\"pool-deposit-ui\">\n      {!address ? (\n        <ConnectButton />\n      ) : (\n        <Box className=\"withdrawal-container\">\n          <Box display=\"flex\" alignItems=\"center\" flexDirection={`${isMobileScreen ? \"column\" : \"row\"}`}>\n            <FormControl className=\"ohm-input\" variant=\"outlined\" color=\"primary\">\n              <InputLabel htmlFor=\"amount-input\"></InputLabel>\n              <OutlinedInput\n                id=\"amount-input\"\n                type=\"number\"\n                placeholder=\"Enter an amount\"\n                className=\"pool-input\"\n                value={quantity}\n                onChange={e => setQuantity(parseFloat(e.target.value))}\n                startAdornment={\n                  <InputAdornment position=\"start\">\n                    <div className=\"logo-holder\">{sohmImg}</div>\n                  </InputAdornment>\n                }\n                labelWidth={0}\n                endAdornment={\n                  <InputAdornment position=\"end\">\n                    <Button variant=\"text\" onClick={setMax}>\n                      Max\n                    </Button>\n                  </InputAdornment>\n                }\n              />\n            </FormControl>\n            <Button\n              className=\"pool-withdraw-button\"\n              variant=\"contained\"\n              color=\"primary\"\n              disabled={isPendingTxn(pendingTransactions, \"pool_withdraw\")}\n              onClick={() => onWithdraw(\"withdraw\")}\n            >\n              {exitFee > 0\n                ? txnButtonText(pendingTransactions, \"pool_withdraw\", \"Withdraw Early & pay \" + exitFee + \" sOHM\")\n                : txnButtonText(pendingTransactions, \"pool_withdraw\", \"Withdraw sOHM\")}\n              {/* Withdraw sOHM */}\n            </Button>\n          </Box>\n          {newOdds > 0 && quantity > 0 && (\n            <Box padding={1}>\n              <Typography color=\"error\" variant=\"body2\">\n                Withdrawing {quantity} sOHM reduces your odds of winning to 1 in {newOdds}&nbsp;\n              </Typography>\n            </Box>\n          )}\n          {exitFee > 0 && (\n            <Box margin={1}>\n              <Typography color=\"error\">\n                Early withdraw will incur a fairness fee of {exitFee}. &nbsp;\n                <Link\n                  href=\"https://v3.docs.pooltogether.com/protocol/prize-pool/fairness\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  color=\"primary\"\n                >\n                  <br />\n                  Read more about Fairness{\" \"}\n                  <SvgIcon component={ArrowUp} style={{ fontSize: \"1rem\", verticalAlign: \"middle\" }} />\n                </Link>\n              </Typography>\n            </Box>\n          )}\n\n          {/* NOTE (Appleseed): added this bc I kept losing track of which accounts I had sOHM in during testing */}\n          <div className={`stake-user-data`}>\n            <div className=\"data-row\">\n              <Typography variant=\"body1\" align=\"left\">\n                Your Pooled Balance (withdrawable)\n              </Typography>\n              <Typography variant=\"body1\" align=\"right\">\n                {isPoolLoading ? (\n                  <Skeleton width=\"80px\" />\n                ) : (\n                  <>{new Intl.NumberFormat(\"en-US\").format(poolBalance)} 33T</>\n                )}\n              </Typography>\n            </div>\n          </div>\n        </Box>\n      )}\n    </Box>\n  );\n};\n\nPoolWithdraw.propTypes = {\n  totalPoolDeposits: PropTypes.number,\n  winners: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  setInfoTooltipMessage: PropTypes.func,\n};\n"]},"metadata":{},"sourceType":"module"}